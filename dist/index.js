"use strict";var o=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var l=Object.getOwnPropertyNames;var p=Object.prototype.hasOwnProperty;var g=(t,e)=>{for(var r in e)o(t,r,{get:e[r],enumerable:!0})},f=(t,e,r,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of l(e))!p.call(t,n)&&n!==r&&o(t,n,{get:()=>e[n],enumerable:!(a=d(e,n))||a.enumerable});return t};var h=t=>f(o({},"__esModule",{value:!0}),t);var w={};g(w,{Figma:()=>b});module.exports=h(w);var s=require("@tiptap/core"),i=require("@tiptap/pm/state"),c=/https:\/\/[\w\.-]+\.?figma.com\/([\w-]+)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/,m=t=>{let e=new URL("https://www.figma.com/embed");return e.searchParams.set("embed_host","tiptap"),e.searchParams.set("embed_origin",window.location.origin),e.searchParams.set("url",t),e.toString()},b=s.Node.create({name:"figma",group:"block",atom:!0,addCommands(){return{setFigma:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t}),unsetFigma:()=>({commands:t})=>t.deleteRange({from:0,to:-1})}},addAttributes(){return{src:{default:null}}},parseHTML(){return[{tag:'iframe[src*="figma.com"]'}]},renderHTML({HTMLAttributes:t}){return["iframe",(0,s.mergeAttributes)(this.options.HTMLAttributes,t,{width:"800",height:"450",allowfullscreen:"true"})]},addInputRules(){return[new s.InputRule({find:c,handler:({match:t,commands:e})=>{let r=t[0],a=m(r);e.setFigma({src:a})}})]},addProseMirrorPlugins(){return[new i.Plugin({key:new i.PluginKey("figmaEmbedPlugin"),props:{handlePaste:(t,e)=>{var a;let r=(a=e.clipboardData)==null?void 0:a.getData("text/plain");if(r&&c.test(r)){let n=m(r);return t.dispatch(t.state.tr.replaceSelectionWith(this.type.create({src:n}))),!0}return!1},handleDOMEvents:{drop:(t,e)=>{var a;let r=(a=e.dataTransfer)==null?void 0:a.getData("text/plain");if(r&&c.test(r)){let n=m(r),u=t.posAtCoords({left:e.clientX,top:e.clientY});if(u)return t.dispatch(t.state.tr.insert(u.pos,this.type.create({src:n}))),!0}return!1}}}})]}});0&&(module.exports={Figma});
